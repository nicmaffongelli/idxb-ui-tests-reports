# Test info

- Name: Type of user: Client >> MW Menu: Design >> Sub-menu: Settings >> Sub-menu: MLS >> Should update MLS Custom Display name and verify it on front-end search page - User: Client-Engage-1-Existing
- Location: /opt/atlassian/pipelines/agent/build/tests/specs/clients/design/settings/mls/mlsGlobalSettings.spec.ts:20:17

# Error details

```
TimeoutError: locator.waitFor: Timeout 15000ms exceeded.
Call log:
  - waiting for locator('tr#mls-a411').locator('td.editable') to be visible

    at MlsSettingsPage.clickCustomDisplayEdit (/opt/atlassian/pipelines/agent/build/tests/pages/client/design/settings/mls/MlsSettingsPage.ts:90:20)
    at MlsSettingsPage.editCustomDisplay (/opt/atlassian/pipelines/agent/build/tests/pages/client/design/settings/mls/MlsSettingsPage.ts:128:20)
    at /opt/atlassian/pipelines/agent/build/tests/specs/clients/design/settings/mls/mlsGlobalSettings.spec.ts:32:46
```

# Page snapshot

```yaml
- navigation:
  - link "IDX Broker":
    - /url: /mgmt/dashboard
    - img "IDX Broker"
  - list:
    - listitem:
      - text: Sandbox
      - strong: "Signed in as:"
      - text: Nic (3265)
    - listitem:
      - text: "12"
      - img
- text: Notifications
- button "Clear All"
- text: retail clients only - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: all clients - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: retail clients only - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: all clients - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: retail clients only - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: all clients - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: retail clients only - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: all clients - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: retail clients only - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: all clients - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: retail clients only - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- text: all clients - high
- button "Dismiss Notification":
  - img "Dismiss Notification"
- navigation:
  - list:
    - listitem: Home +
    - listitem: Leads +
    - listitem: Listings +
    - listitem: Messages +
    - listitem:
      - link "MLS":
        - /url: /mgmt/mls-membership
    - listitem: Design -
    - listitem: Account +
    - listitem: Support +
- text: Your account is past due. To maintain service, please update your billing
- link "here.":
  - /url: https://middleware.idxsandbox.com/mgmt/billing/edit
- listitem:
  - link "Page Help":
    - /url: "#"
- heading "MLS Settings Customize the MLS's on your account" [level=1]
- list:
  - listitem:
    - link "MLS Renaming":
      - /url: "#mls"
  - listitem:
    - link "Property Types":
      - /url: "#propTypes"
  - listitem:
    - link "Core Fields":
      - /url: "#coreFields"
  - listitem:
    - link "MLS Advanced Fields":
      - /url: "#advancedFields"
- heading "MLS Rename your MLS" [level=2]
- grid:
  - text: "Search:"
  - textbox "Search:"
  - table:
    - rowgroup:
      - 'row "IDX ID: activate to sort column descending Default Display: activate to sort column ascending Custom Display: activate to sort column ascending"':
        - 'columnheader "IDX ID: activate to sort column descending"': IDX ID
        - 'columnheader "Default Display: activate to sort column ascending"': Default Display
        - 'columnheader "Custom Display: activate to sort column ascending"': Custom Display
    - alert:
      - row "b001 Regional Multiple Listing Service Regional Multiple Listing Service":
        - cell "b001"
        - cell "Regional Multiple Listing Service"
        - cell "Regional Multiple Listing Service"
  - text: 1 total MLS(s)
- paragraph:
  - text: Services Â© 2025
  - link "IDX Broker":
    - /url: https://www.idxbroker.com
  - text: . All rights reserved.
- status
- status
```

# Test source

```ts
   1 | import { Page, Locator, expect } from '@playwright/test';
   2 | import { BasePage } from '../../../../BasePage';
   3 | import { waitForPageToBeFullyLoaded } from '../../../../../utils/page-utils';
   4 |
   5 | /**
   6 |  * MlsSettingsPage
   7 |  * Page Object Model for the MLS Settings page in the middleware application
   8 |  */
   9 | export class MlsSettingsPage extends BasePage {
   10 |     // Table elements
   11 |     readonly mlsTable: Locator;
   12 |     readonly customDisplayInput: Locator;
   13 |
   14 |     /**
   15 |      * Constructor for MlsSettingsPage
   16 |      * @param page - Playwright page object
   17 |      */
   18 |     constructor(page: Page) {
   19 |         super(page);
   20 |         
   21 |         // Initialize locators
   22 |         this.mlsTable = page.locator('#mlsTable');
   23 |         // Input field appears after clicking edit
   24 |         this.customDisplayInput = page.locator('input[name="value"]');
   25 |     }
   26 |
   27 |     /**
   28 |      * Get the table header locator.
   29 |      * @returns Locator for the table header.
   30 |      */
   31 |     private get tableHeader(): Locator {
   32 |         return this.mlsTable.locator('thead');
   33 |     }
   34 |
   35 |     /**
   36 |      * Get the index of a column based on its header text.
   37 |      * @param headerText - The text of the header to find.
   38 |      * @returns Promise resolving to the 0-based index of the column.
   39 |      * @throws Error if the header is not found.
   40 |      */
   41 |     private async getColumnIndexByHeaderText(headerText: string): Promise<number> {
   42 |         const headers = this.tableHeader.locator('th');
   43 |         const count = await headers.count();
   44 |         for (let i = 0; i < count; i++) {
   45 |             const text = await headers.nth(i).textContent();
   46 |             if (text?.trim() === headerText) {
   47 |                 return i;
   48 |             }
   49 |         }
   50 |         throw new Error(`Header with text "${headerText}" not found.`);
   51 |     }
   52 |
   53 |     /**
   54 |      * Get the locator for a specific row using its ID attribute.
   55 |      * @param mlsId - The MLS ID used in the row's ID (e.g., 'a411').
   56 |      * @returns Locator for the table row.
   57 |      */
   58 |     private getRowByMlsId(mlsId: string): Locator {
   59 |         // Use the specific ID of the row
   60 |         return this.page.locator(`tr#mls-${mlsId}`);
   61 |     }
   62 |
   63 |     /**
   64 |      * Get the locator for the Custom Display cell for a given MLS ID.
   65 |      * Uses the 'editable' class specific to this column within the row identified by ID.
   66 |      * @param mlsId - The MLS ID of the target row.
   67 |      * @returns Locator for the Custom Display cell.
   68 |      */
   69 |     private getCustomDisplayCell(mlsId: string): Locator {
   70 |         const row = this.getRowByMlsId(mlsId);
   71 |         // Target the cell within the ID'd row that has the 'editable' class
   72 |         return row.locator('td.editable');
   73 |     }
   74 |
   75 |     /**
   76 |      * Navigate to the MLS Settings page.
   77 |      */
   78 |     async goto(): Promise<void> {
   79 |         await this.page.goto(`${this.envConfig.MW_BASE_URL}/mgmt/mls-settings`);
   80 |         await waitForPageToBeFullyLoaded(this.page);
   81 |     }
   82 |
   83 |     /**
   84 |      * Double-clicks the Custom Display cell to make it editable.
   85 |      * @param mlsId - The MLS ID of the target row (e.g., 'a411').
   86 |      */
   87 |     async clickCustomDisplayEdit(mlsId: string): Promise<void> {
   88 |         const cell = this.getCustomDisplayCell(mlsId);
   89 |         // Ensure the cell is stable before double-clicking
>  90 |         await cell.waitFor({ state: 'visible', timeout: 15000 });
      |                    ^ TimeoutError: locator.waitFor: Timeout 15000ms exceeded.
   91 |         await cell.dblclick({ timeout: 10000 });
   92 |     }
   93 |
   94 |     /**
   95 |      * Set a new value for the Custom Display field for a specific MLS row.
   96 |      * Assumes the edit mode is active (cell was double-clicked).
   97 |      * @param mlsId - The MLS ID of the target row.
   98 |      * @param value - The new value to set.
   99 |      */
  100 |     async setCustomDisplayValue(mlsId: string, value: string): Promise<void> {
  101 |         // Wait for the input field to appear after double-click
  102 |         await this.customDisplayInput.waitFor({ state: 'visible', timeout: 5000 });
  103 |         await this.customDisplayInput.fill(value);
  104 |         await this.customDisplayInput.press('Enter');
  105 |         // Wait for the value to be saved by checking the specific cell
  106 |         const cell = this.getCustomDisplayCell(mlsId);
  107 |         // Add a small wait for the text update to propagate after Enter press
  108 |         await this.page.waitForTimeout(500);
  109 |         await expect(cell).toContainText(value, { timeout: 10000 });
  110 |     }
  111 |
  112 |     /**
  113 |      * Get the current Custom Display value for a specific MLS row.
  114 |      * @param mlsId - The MLS ID of the target row.
  115 |      * @returns Promise resolving to the current custom display value.
  116 |      */
  117 |     async getCustomDisplayValue(mlsId: string): Promise<string> {
  118 |         const cell = this.getCustomDisplayCell(mlsId);
  119 |         return await cell.textContent() || '';
  120 |     }
  121 |
  122 |     /**
  123 |      * Edit the Custom Display value for a specific MLS row.
  124 |      * @param mlsId - The MLS ID of the target row (e.g., 'a411').
  125 |      * @param newValue - The new value to set for Custom Display.
  126 |      */
  127 |     async editCustomDisplay(mlsId: string, newValue: string): Promise<void> {
  128 |         await this.clickCustomDisplayEdit(mlsId);
  129 |         // Pass mlsId to setCustomDisplayValue
  130 |         await this.setCustomDisplayValue(mlsId, newValue);
  131 |     }
  132 | }
  133 |
```