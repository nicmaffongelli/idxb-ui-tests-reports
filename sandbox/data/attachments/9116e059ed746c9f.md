# Test info

- Name: Type of user: Client >> MW Menu: Design >> Sub-menu: Settings >> Sub-menu: Locations - Create, Edit, Verify, Delete List >> Edit County List, Verify in FE, and Revert
- Location: /opt/atlassian/pipelines/agent/build/tests/specs/clients/design/settings/locations/createNewLocationList.spec.ts:90:21

# Error details

```
TimeoutError: locator.check: Timeout 20000ms exceeded.
Call log:
  - waiting for locator('#currentList').getByRole('checkbox', { name: 'Adams, WA' })

    at ManageLocationListsPage.selectItemInCurrentList (/opt/atlassian/pipelines/agent/build/tests/pages/client/design/settings/Locations/ManageLocationListsPage.ts:84:50)
    at /opt/atlassian/pipelines/agent/build/tests/specs/clients/design/settings/locations/createNewLocationList.spec.ts:98:58
```

# Page snapshot

```yaml
- navigation:
  - link "IDX Broker":
    - /url: /mgmt/dashboard
    - img "IDX Broker"
  - list:
    - listitem:
      - text: Sandbox
      - strong: "Signed in as:"
      - text: QA (3710)
    - listitem:
      - img
- text: Notifications
- strong: You’re all caught up! Keep an eye out for new notifications. We’ll post them here.
- navigation:
  - list:
    - listitem: Home +
    - listitem: Leads +
    - listitem: Listings +
    - listitem: Messages +
    - listitem:
      - link "MLS":
        - /url: /mgmt/mls-membership
    - listitem: Design +
    - listitem: Account +
    - listitem: Support +
- heading "Dynamic County List for RMLS" [level=1]
- heading "Current List" [level=4]
- checkbox "Baker, OR"
- text: Baker, OR
- checkbox "Benton, OR"
- text: Benton, OR
- checkbox "Clackamas, OR"
- text: Clackamas, OR
- checkbox "Clark, WA"
- text: Clark, WA
- checkbox "Clatsop, OR"
- text: Clatsop, OR
- checkbox "Columbia, OR"
- text: Columbia, OR
- checkbox "Columbia, WA"
- text: Columbia, WA
- checkbox "Coos, OR"
- text: Coos, OR
- checkbox "Cowlitz, WA"
- text: Cowlitz, WA
- checkbox "Crook, OR"
- text: Crook, OR
- checkbox "Curry, OR"
- text: Curry, OR
- checkbox "Deschutes, OR"
- text: Deschutes, OR
- checkbox "Douglas, OR"
- text: Douglas, OR
- checkbox "Gilliam, OR"
- text: Gilliam, OR
- checkbox "Grant, OR"
- text: Grant, OR
- checkbox "Grays Harbor, WA"
- text: Grays Harbor, WA
- checkbox "Harney, OR"
- text: Harney, OR
- checkbox "Hood River, OR"
- text: Hood River, OR
- checkbox "Jackson, OR"
- text: Jackson, OR
- checkbox "Jefferson, OR"
- text: Jefferson, OR
- checkbox "Josephine, OR"
- text: Josephine, OR
- checkbox "King, WA"
- text: King, WA
- checkbox "Kitsap, WA"
- text: Kitsap, WA
- checkbox "Klamath, OR"
- text: Klamath, OR
- checkbox "Klickitat, WA"
- text: Klickitat, WA
- checkbox "Lake, OR"
- text: Lake, OR
- checkbox "Lane, OR"
- text: Lane, OR
- checkbox "Lewis, WA"
- text: Lewis, WA
- checkbox "Lincoln, OR"
- text: Lincoln, OR
- checkbox "Linn, OR"
- text: Linn, OR
- checkbox "Malheur, OR"
- text: Malheur, OR
- checkbox "Marion, OR"
- text: Marion, OR
- checkbox "Morrow, OR"
- text: Morrow, OR
- checkbox "Multnomah, OR"
- text: Multnomah, OR
- checkbox "Pacific, WA"
- text: Pacific, WA
- checkbox "Polk, OR"
- text: Polk, OR
- checkbox "Sherman, OR"
- text: Sherman, OR
- checkbox "Skagit, WA"
- text: Skagit, WA
- checkbox "Skamania, WA"
- text: Skamania, WA
- checkbox "Snohomish, WA"
- text: Snohomish, WA
- checkbox "Tillamook, OR"
- text: Tillamook, OR
- checkbox "Umatilla, OR"
- text: Umatilla, OR
- checkbox "Union, OR"
- text: Union, OR
- checkbox "Wahkiakum, WA"
- text: Wahkiakum, WA
- checkbox "Wallowa, OR"
- text: Wallowa, OR
- checkbox "Wasco, OR"
- text: Wasco, OR
- checkbox "Washington, OR"
- text: Washington, OR
- checkbox "Wheeler, OR"
- text: Wheeler, OR
- checkbox "Yamhill, OR"
- text: Yamhill, OR
- button "Remove Selected"
- heading "Add List Item" [level=4]
- button "Add"
- textbox
- heading "Previously Removed" [level=4]
- button "Restore Selected"
- button "Take Me Back to List Management"
- paragraph:
  - text: Services © 2025
  - link "IDX Broker":
    - /url: https://www.idxbroker.com
  - text: . All rights reserved.
```

# Test source

```ts
   1 | import { type Page, type Locator, expect } from '@playwright/test';
   2 | import { BasePage } from '../../../../BasePage';
   3 | import { waitForPageToBeFullyLoaded } from '../../../../../utils/page-utils';
   4 |
   5 | export class ManageLocationListsPage extends BasePage {
   6 |   // Locators
   7 |   readonly searchInput: Locator;
   8 |   readonly deleteButton: Locator; // Main bulk delete button
   9 |   readonly confirmYesButton: Locator;
   10 |   readonly notificationContainer: Locator;
   11 |
   12 |   // Locators added for editing
   13 |   readonly currentListItemCheckbox: (itemName: string) => Locator;
   14 |   readonly removeSelectedButton: Locator;
   15 |   readonly addItemInput: Locator;
   16 |   readonly itemSuggestion: (suggestionText: string) => Locator;
   17 |   readonly addItemButton: Locator;
   18 |   readonly revertChangesIcon: (listType: 'city' | 'county' | 'zipcode') => Locator;
   19 |
   20 |   /**
   21 |    * Constructor for ManageLocationListsPage
   22 |    * @param page - Playwright page object
   23 |    */
   24 |   constructor(page: Page) {
   25 |     super(page);
   26 |
   27 |     this.searchInput = page.getByRole('textbox', { name: 'Search:' });
   28 |     // Locating the bulk delete link outside the table
   29 |     this.deleteButton = page.locator('a.bulk-action[data-bulk-action="bulk-delete"]');
   30 |     this.confirmYesButton = page.getByRole('button', { name: 'Yes' });
   31 |     this.notificationContainer = page.locator('#jGrowl');
   32 |
   33 |     // Initializing edit-related locators
   34 |     this.currentListItemCheckbox = (itemName) => page.locator('#currentList').getByRole('checkbox', { name: itemName });
   35 |     this.removeSelectedButton = page.getByRole('button', { name: 'Remove Selected' });
   36 |     this.addItemInput = page.locator('#addListItem');
   37 |     this.itemSuggestion = (suggestionText) => page.getByText(suggestionText);
   38 |     this.addItemButton = page.locator('form:has(#addListItem)').getByRole('button', { name: 'Add' });
   39 |     // Revert icon locator remains robust using data attributes
   40 |     this.revertChangesIcon = (listType) => page.locator(`span.idx-icon-trash[data-listtype="dynamic"][data-type="${listType}"]`);
   41 |   }
   42 |
   43 |   // --- Helper to get specific list row (Refactored) ---
   44 |   private getListRow(listName: string, listType: 'city' | 'county' | 'zipcode'): Locator {
   45 |     // Capitalize first letter for matching text like "County", "City"
   46 |     const listTypeStr = listType.charAt(0).toUpperCase() + listType.slice(1);
   47 |     // Find rows within the table body, excluding group headers.
   48 |     // Filter by finding a td containing listName AND a td containing listTypeStr.
   49 |     return this.page.locator('#DataTables_Table_0 tbody tr')
   50 |       .filter({ hasNot: this.page.locator('td[colspan="4"]') }) // Exclude group rows
   51 |       .filter({ has: this.page.locator(`td:has-text("${listName}")`) })
   52 |       .filter({ has: this.page.locator(`td:has-text("${listTypeStr}")`) });
   53 |   }
   54 |
   55 |   // --- Actions ---
   56 |
   57 |   /**
   58 |    * Navigate directly to the Manage Location Lists page.
   59 |    */
   60 |   async goto(): Promise<void> {
   61 |     await this.page.goto(this.envConfig.MW_BASE_URL + '/mgmt/location-lists');
   62 |     await waitForPageToBeFullyLoaded(this.page);
   63 |   }
   64 |
   65 |   /**
   66 |    * Clicks the Edit icon for a specific list. (Refactored)
   67 |    * @param listName - The name identifying the list row (e.g., 'RMLS Dynamic MLS List').
   68 |    * @param listType - The type of list ('city', 'county', 'zipcode').
   69 |    */
   70 |   async clickEditList(listName: string, listType: 'city' | 'county' | 'zipcode'): Promise<void> {
   71 |     const row = this.getListRow(listName, listType);
   72 |     // Find the edit link within the specific row, independent of column order
   73 |     const editLink = row.locator('a[href*="/edit"] span.idx-icon-edit');
   74 |     await editLink.click();
   75 |     // Wait for the edit view to load
   76 |     await expect(this.addItemInput).toBeVisible();
   77 |   }
   78 |
   79 |   /**
   80 |    * Selects an item's checkbox in the 'Current List' section (during edit).
   81 |    * @param itemName - The exact name of the item in the list.
   82 |    */
   83 |   async selectItemInCurrentList(itemName: string): Promise<void> {
>  84 |     await this.currentListItemCheckbox(itemName).check();
      |                                                  ^ TimeoutError: locator.check: Timeout 20000ms exceeded.
   85 |   }
   86 |
   87 |   /**
   88 |    * Clicks the 'Remove Selected' button (during edit).
   89 |    */
   90 |   async clickRemoveSelected(itemName: string): Promise<void> {
   91 |     await this.removeSelectedButton.click();
   92 |     await expect(this.currentListItemCheckbox(itemName)).not.toBeVisible();
   93 |   }
   94 |
   95 |   /**
   96 |    * Adds an item to the list during edit mode (e.g., a county).
   97 |    * @param itemName - The item name to type into the input.
   98 |    * @param suggestionText - The exact text of the suggestion to click.
   99 |    */
  100 |   async addItemToList(itemName: string, suggestionText: string): Promise<void> {
  101 |     await this.addItemInput.click();
  102 |     await this.addItemInput.pressSequentially(itemName, { delay: 100 });
  103 |     await this.itemSuggestion(suggestionText).click();
  104 |     await this.addItemButton.click();
  105 |     await expect(this.currentListItemCheckbox(suggestionText)).toBeVisible();
  106 |   }
  107 |
  108 |   /**
  109 |    * Clicks the revert changes (trash) icon for a specific dynamic list type.
  110 |    * @param listType - The type of list ('city', 'county', 'zipcode').
  111 |    */
  112 |   async clickRevertChanges(listType: 'city' | 'county' | 'zipcode'): Promise<void> {
  113 |     await this.revertChangesIcon(listType).click();
  114 |     await expect(this.notificationContainer).toContainText('Items deleted successfully.');
  115 |   }
  116 |
  117 |   /**
  118 |    * Searches for a specific location list by name.
  119 |    * @param listName - The name of the list to search for.
  120 |    */
  121 |   async searchForList(listName: string): Promise<void> {
  122 |     await this.searchInput.click();
  123 |     await this.searchInput.fill(listName);
  124 |     await this.searchInput.press('Enter');
  125 |     // Wait for at least one matching row to appear (using refactored getListRow)
  126 |     await expect(this.getListRow(listName, 'city').or(this.getListRow(listName, 'county')).or(this.getListRow(listName, 'zipcode'))).toBeVisible();
  127 |   }
  128 |
  129 |   /**
  130 |    * Selects the checkbox for a given list name in the results table. (Refactored)
  131 |    * Used for bulk actions.
  132 |    * @param listName - The name of the list row.
  133 |    * @param listType - The type of list ('city', 'county', 'zipcode').
  134 |    */
  135 |   async selectListCheckbox(listName: string, listType: 'city' | 'county' | 'zipcode'): Promise<void> {
  136 |     const listRow = this.getListRow(listName, listType);
  137 |     // Find checkbox within the specific row
  138 |     await listRow.locator('input[type="checkbox"].bulk-select').check();
  139 |   }
  140 |
  141 |   /**
  142 |    * Clicks the main 'Delete' button/link (for performing bulk delete action).
  143 |    */
  144 |   async clickBulkDeleteButton(): Promise<void> {
  145 |     await this.deleteButton.click();
  146 |   }
  147 |
  148 |   /**
  149 |    * Clicks the specific delete icon within a custom list's row. (New Helper)
  150 |    * @param listName - The name of the list row.
  151 |    * @param listType - The type of list ('city', 'county', 'zipcode').
  152 |    */
  153 |   private async clickDeleteIconForRow(listName: string, listType: 'city' | 'county' | 'zipcode'): Promise<void> {
  154 |     const listRow = this.getListRow(listName, listType);
  155 |     // Find the specific trash icon for custom lists within the row
  156 |     await listRow.locator('span.idx-icon-trash[data-listtype="custom"]').click();
  157 |     //Verifies the success message after deleting items.
  158 |     await this.verifyDeleteSuccessNotification();
  159 |   }
  160 |
  161 |   /**
  162 |    * Confirms the deletion/revert action in the modal dialog.
  163 |    */
  164 |   async confirmAction(): Promise<void> {
  165 |     await this.confirmYesButton.click();
  166 |   }
  167 |
  168 |   /**
  169 |    * Verifies the success message after deleting items.
  170 |    */
  171 |   async verifyDeleteSuccessNotification(): Promise<void> {
  172 |     await expect(this.notificationContainer).toContainText('Items deleted successfully.');
  173 |   }
  174 |
  175 |   /**
  176 |    * Combines steps to delete a specific *custom* list by name using its row icon. (Refactored)
  177 |    * @param listName - The name of the custom list to delete.
  178 |    * @param listType - The type of list ('city', 'county', 'zipcode').
  179 |    */
  180 |   async deleteList(listName: string, listType: 'city' | 'county' | 'zipcode'): Promise<void> {
  181 |     await this.searchForList(listName);
  182 |     // Click the specific delete icon for this custom list row
  183 |     await this.clickDeleteIconForRow(listName, listType);
  184 |     // Add a wait for the item to visually disappear from the table
```