# Test info

- Name: Type of user: Client >> MW Menu: Account >> Sub-menu: Users >> Sub-menu: Agents >> Delete All Agents - User: Client-Elite-1-Existing
- Location: /opt/atlassian/pipelines/agent/build/tests/specs/clients/account/users/agents.spec.ts:40:25

# Error details

```
TimeoutError: locator.click: Timeout 20000ms exceeded.
Call log:
  - waiting for getByRole('button', { name: 'Yes' })

    at ManageAgentsPage.deleteSelectedAgents (/opt/atlassian/pipelines/agent/build/tests/pages/client/account/users/ManageAgentsPage.ts:168:43)
    at /opt/atlassian/pipelines/agent/build/tests/specs/clients/account/users/agents.spec.ts:53:25
```

# Page snapshot

```yaml
- navigation:
  - link "IDX Broker":
    - /url: /mgmt/dashboard
    - img "IDX Broker"
  - list:
    - listitem:
      - text: Staging
      - strong: "Signed in as:"
      - text: Nic (3979)
    - listitem:
      - img
- text: Notifications
- strong: You’re all caught up! Keep an eye out for new notifications. We’ll post them here.
- navigation:
  - list:
    - listitem: Home +
    - listitem: Leads +
    - listitem: Listings +
    - listitem: Messages +
    - listitem:
      - link "MLS":
        - /url: /mgmt/mls-membership
    - listitem: Design +
    - listitem: Account -
    - listitem: Support +
- listitem:
  - link "Page Help":
    - /url: "#"
- heading "Agents manage your agents" [level=1]
- link "Add Agent":
  - /url: /mgmt/agents/create
- link "Import":
  - /url: /mgmt/agents/import
- link "Export":
  - /url: /mgmt/users/exports/create
- link "Set Global Permissions":
  - /url: "#globalPermissions"
- grid:
  - text: Show
  - combobox "Show entries":
    - option "10" [selected]
    - option "25"
    - option "50"
    - option "100"
  - text: "entries Search:"
  - 'textbox "Search: ?"'
  - link "?":
    - /url: "#"
  - table:
    - rowgroup:
      - 'row "First Name: activate to sort column ascending Last Name: activate to sort column descending User ID: activate to sort column ascending Email: activate to sort column ascending Category: activate to sort column ascending Last Login: activate to sort column ascending Tools"':
        - columnheader:
          - checkbox [checked]
        - 'columnheader "First Name: activate to sort column ascending"': First Name
        - 'columnheader "Last Name: activate to sort column descending"': Last Name
        - 'columnheader "User ID: activate to sort column ascending"': User ID
        - 'columnheader "Email: activate to sort column ascending"': Email
        - 'columnheader "Category: activate to sort column ascending"': Category
        - 'columnheader "Last Login: activate to sort column ascending"': Last Login
        - columnheader "Tools"
    - alert:
      - row "Qa UiAutomation 36738 idxqamv+e9817419-5020-48e1-83bf-2fe70991711e@gmail.com Agent Never    ":
        - cell:
          - checkbox
        - cell "Qa"
        - cell "UiAutomation"
        - cell "36738"
        - cell "idxqamv+e9817419-5020-48e1-83bf-2fe70991711e@gmail.com"
        - cell "Agent"
        - cell "Never"
        - cell "   ":
          - link "":
            - /url: /mgmt/vlogin/30/3979/36738
          - link "":
            - /url: /mgmt/agents/36738/edit
          - link "":
            - /url: https://testing1210elite.idxstaging.com/idx/agent/36738/qauiautomation
          - text: 
  - text: Showing 1 to 1 of 1 entries
  - list:
    - listitem:
      - link "← Previous":
        - /url: "#"
    - listitem:
      - link "1":
        - /url: "#"
    - listitem:
      - link "Next →":
        - /url: "#"
- paragraph:
  - text: "With selected:"
  - link "Delete Agents":
    - /url: "#bulkActionForm"
- paragraph:
  - text: Services © 2025
  - link "IDX Broker":
    - /url: https://www.idxbroker.com
  - text: . All rights reserved.
```

# Test source

```ts
   68 |         this.successMessage = page.locator('#jGrowl');
   69 |     }
   70 |     
   71 |     /**
   72 |      * Navigate to the Add Agent page
   73 |      */
   74 |     async navigateToManageAgentPage() {
   75 |         // Navigate through the menu structure to reach Add Agent page
   76 |         await this.page.locator('#idx-mw-navigation-bar').getByAltText('icon').click();
   77 |         await this.page.locator('span').filter({ hasText: /^Account$/ }).click();
   78 |         await this.page.getByText('Users', { exact: true }).click();
   79 |         await this.page.getByRole('link', { name: 'Agents' }).click();
   80 |     }
   81 |
   82 |     /**
   83 |     * Go directly to the Add Agent page
   84 |     */
   85 |     async goto(){
   86 |         await this.page.goto(envConfig.MW_BASE_URL + '/mgmt/agents');
   87 |     }
   88 |     
   89 |     /**
   90 |      * Search for an agent by a search term
   91 |      * @param searchTerm - The term to search for (email, name, etc.)
   92 |      */
   93 |     async searchForAgent(searchTerm: string) {
   94 |         await this.searchInput.fill(searchTerm);
   95 |         await this.page.keyboard.press('Enter');
   96 |         await waitForPageToBeFullyLoaded(this.page);
   97 |         // Wait for the search to complete
   98 |         await this.page.waitForTimeout(500); // Small delay to ensure the search is processed
   99 |     }
  100 |     
  101 |     /**
  102 |      * Clear the search input
  103 |      */
  104 |     async clearSearch() {
  105 |         await this.clearSearchButton.click();
  106 |         await waitForPageToBeFullyLoaded(this.page);
  107 |         await this.page.waitForTimeout(500); // Small delay to ensure the search is cleared
  108 |     }
  109 |     
  110 |     /**
  111 |      * Check if an agent exists in the table by email
  112 |      * @param email - Email address to search for
  113 |      * @returns True if agent exists, false otherwise
  114 |      */
  115 |     async agentExistsByEmail(email: string) {
  116 |         const rowCount = await this.page.locator(`td.editable:text-is("${email}")`).count();
  117 |         return rowCount > 0;
  118 |     }
  119 |     
  120 |     /**
  121 |      * Verify agent exists by email
  122 |      * @param email - Email address to verify
  123 |      */
  124 |     async verifyAgentExistsByEmail(email: string) {
  125 |         await this.searchForAgent(email);
  126 |         const agentRow = this.page.locator(`tr:has(td:text-is("${email}"))`);
  127 |         await expect(agentRow).toBeVisible();
  128 |         await expect(agentRow).toContainText(email);
  129 |     }
  130 |     
  131 |
  132 |     /**
  133 |      * Edit an agent by email
  134 |      * @param email - Email address of the agent to edit
  135 |      */
  136 |     async editAgentByEmail(email: string) {
  137 |         await this.searchForAgent(email);
  138 |         const editButton = this.page.locator(`tr:has(td:text-is("${email}")) .idx-icon-edit`);
  139 |         await editButton.click();
  140 |         await this.page.waitForURL('**/mgmt/agents/**/edit');
  141 |     }
  142 |     
  143 |     /**
  144 |      * Login as an agent by email
  145 |      * @param email - Email address of the agent to login as
  146 |      */
  147 |     async loginAsAgentByEmail(email: string) {
  148 |         await this.searchForAgent(email);
  149 |         const loginButton = this.page.locator(`tr:has(td:text-is("${email}")) .idx-icon-login`);
  150 |         await loginButton.click();
  151 |     }
  152 |     
  153 |     /**
  154 |      * Select all agents using the "Select All" checkbox
  155 |      */
  156 |     async selectAllAgents() {
  157 |         await this.selectAllCheckbox.check();
  158 |         // Adding a small delay to ensure all checkboxes are updated
  159 |         await this.page.waitForTimeout(300);
  160 |     }
  161 |
  162 |     /**
  163 |      * Delete selected agents
  164 |      */
  165 |     async deleteSelectedAgents() {
  166 |         await this.deleteSelectedAgentsButton.click();
  167 |         // Assuming there's a confirmation dialog
> 168 |         await this.confirmDialogYesButton.click();
      |                                           ^ TimeoutError: locator.click: Timeout 20000ms exceeded.
  169 |         await waitForPageToBeFullyLoaded(this.page);
  170 |     }
  171 |     
  172 |     /**
  173 |      * Verify a specific success message is shown in the jGrowl notification
  174 |      * @param expectedMessage The expected message text to verify
  175 |      */
  176 |     async verifySuccessMessage(): Promise<void> {
  177 |         // Wait for the jGrowl notification to appear
  178 |         await this.successMessage.waitFor({ state: 'visible' });
  179 |         
  180 |         // Verify the text matches what we expect
  181 |         await expect(this.successMessage).toContainText('All Agents you selected have been deleted.');
  182 |     }
  183 |     
  184 | }
```