# Test info

- Name: Create a Showcase Legacy Widget with Custom Search and delete it after the test >> Create Showcase Legacy Widget with Custom Search - User: Client-Engage-1-Existing
- Location: /opt/atlassian/pipelines/agent/build/src/tests/specs/clients/06_design/03_widgets/legacyWidgets.spec.ts:13:13

# Error details

```
TimeoutError: locator.click: Timeout 20000ms exceeded.
Call log:
  - waiting for locator('#widgetTypeSelector')
    - locator resolved to <button data-toggle="dropdown" id="widgetTypeSelector" class="btn btn-info dropdown-toggle">…</button>
  - attempting click action
    2 × waiting for element to be visible, enabled and stable
      - element is not stable
    - retrying click action
    - waiting 20ms
    2 × waiting for element to be visible, enabled and stable
      - element is not stable
    - retrying click action
      - waiting 100ms
    38 × waiting for element to be visible, enabled and stable
       - element is not visible
     - retrying click action
       - waiting 500ms

    at AddLegacyWidgetPage.selectWidgetType (/opt/atlassian/pipelines/agent/build/src/page-objects/client/06_design/03_widgets/AddLegacyWidgetPage.ts:180:39)
    at AddLegacyWidgetPage.createShowcaseWidgetWithCustomSearch (/opt/atlassian/pipelines/agent/build/src/page-objects/client/06_design/03_widgets/AddLegacyWidgetPage.ts:398:20)
    at /opt/atlassian/pipelines/agent/build/src/tests/specs/clients/06_design/03_widgets/legacyWidgets.spec.ts:20:46
```

# Page snapshot

```yaml
- navigation:
  - link "IDX Broker":
    - /url: /mgmt/dashboard
    - img "IDX Broker"
  - list:
    - listitem
- text: Notifications
- strong: You’re all caught up! Keep an eye out for new notifications. We’ll post them here.
- navigation:
  - list:
    - listitem
    - listitem
    - listitem
- paragraph:
  - text: Services © 2025
  - link "IDX Broker":
    - /url: https://www.idxbroker.com
  - text: . All rights reserved.
- status
```

# Test source

```ts
   80 |
   81 |     // Status option
   82 |     readonly activeStatusOption: Locator;
   83 |
   84 |     /**
   85 |      * Constructor - initializes the page object and locators
   86 |      * @param page - Playwright page object
   87 |      */
   88 |     constructor(page: Page) {
   89 |         super(page);
   90 |         
   91 |         // Widget type selectors
   92 |         this.widgetTypeSelector = page.locator('#widgetTypeSelector');
   93 |         this.widgetTypeDropdown = page.locator('#widgetTypeDropdown');
   94 |         this.showcaseWidgetType = page.locator('a.widgetType[href="#showcase"]');
   95 |         this.slideshowWidgetType = page.locator('a.widgetType[href="#slideshow"]');
   96 |         this.carouselWidgetType = page.locator('a.widgetType[href="#carousel"]');
   97 |         this.quickSearchWidgetType = page.locator('a.widgetType[href="#quicksearch"]');
   98 |         this.mapSearchWidgetType = page.locator('a.widgetType[href="#mapsearch"]');
   99 |         this.leadLoginWidgetType = page.locator('a.widgetType[href="#leadlogin"]');
  100 |         this.leadSignupWidgetType = page.locator('a.widgetType[href="#leadsignup"]');
  101 |         this.featuredAgentWidgetType = page.locator('a.widgetType[href="#featuredagent"]');
  102 |         
  103 |         // Property set selectors
  104 |         this.propSetContainer = page.locator('#propSetContainer');
  105 |         this.propSetSelector = page.locator('#propSetSelector');
  106 |         this.featuredPropSet = page.locator('a.propSet[href="#featured"]');
  107 |         this.supplementalPropSet = page.locator('a.propSet[href="#supplemental"]');
  108 |         this.featuredSupplementalPropSet = page.locator('a.propSet[href="#featuredSupplemental"]');
  109 |         this.agentPropSet = page.locator('a.propSet[href="#agent"]');
  110 |         this.soldPendingPropSet = page.locator('a.propSet[href="#soldPending"]');
  111 |         this.customSearchPropSet = page.locator('a.propSet[href="#customSearch"]');
  112 |         this.customListPropSet = page.locator('a.propSet[href="#customList"]');
  113 |         this.polygonSearchPropSet = page.locator('a.propSet[href="#polygonSearch"]');
  114 |         this.copyAndPastePropSet = page.locator('a.propSet[href="#copyAndPaste"]');
  115 |         
  116 |         // Search page selector
  117 |         this.searchPageSelector = page.getByRole('link', { name: 'Choose a search page' });
  118 |         this.advancedSearchOption = page.locator('#select2-result-label-3');
  119 |         
  120 |         // Form elements common to most widget types
  121 |         this.widgetNameInput = page.locator('#showcase-form #name');//page.locator('#name');
  122 |         this.widthInput = page.locator('#width');
  123 |         this.heightInput = page.locator('#heigh');
  124 |         this.buildWidgetButton = page.getByRole('button', { name: 'Build Widget' });
  125 |         
  126 |         // Property type selectors (for search forms)
  127 |         this.propertyTypeDropdown = page.locator('#s2id_IDX-pt');//page.getByRole('link', { name: 'Property Type' });
  128 |         this.residentialPropertyType = page.getByRole('option', { name: 'Residential' });//page.locator('#select2-result-label-25');
  129 |         this.landPropertyType = page.locator('#select2-result-label-27');
  130 |         
  131 |         // Search criteria selectors
  132 |         this.statusDropdown = page.getByRole('textbox', { name: 'Status' });
  133 |         this.cityCountyPostalInput = page.getByRole('textbox', { name: /City/ });;//page.getByRole('textbox', { name: 'City, County, Postal Code' });
  134 |         this.minPriceDropdown = page.getByRole('link', { name: 'Min Price' });
  135 |         this.minPriceInput = page.getByRole('combobox', { name: 'Min Price' });
  136 |         
  137 |         // Post-creation elements
  138 |         this.widgetCodeContainer = page.getByText('<script charset="UTF-8" type');
  139 |         this.previewWidgetButton = page.getByRole('link', { name: 'Preview widget' });
  140 |         this.backToWidgetsListButton = page.getByRole('button', { name: 'Back to Widgets List' });
  141 |
  142 |         // Search page result labels
  143 |         this.advancedSearchResultLabel = page.locator('#select2-result-label-3');
  144 |         this.basicSearchResultLabel = page.locator('text=Basic Search');
  145 |         this.addressResultLabel = page.locator('text=Address');
  146 |         this.listingIdResultLabel = page.locator('text=Listing ID');
  147 |         this.emailUpdateSignupResultLabel = page.locator('text=Email Update Signup');
  148 |
  149 |         // Property type result labels
  150 |         this.commercialSaleResultLabel = page.locator('text=Commercial Sale');
  151 |         this.multiFamilyResultLabel = page.locator('text=Multi Family');
  152 |
  153 |         // Price option
  154 |         this.minPriceOption = page.getByRole('option', { name: 'Min Price: $' });
  155 |
  156 |         // Property type links
  157 |         this.landPropertyLink = page.getByRole('link', { name: 'Land' });
  158 |         this.commercialSalePropertyLink = page.getByRole('link', { name: 'Commercial Sale' });
  159 |         this.multiFamilyPropertyLink = page.getByRole('link', { name: 'Multi Family' });
  160 |
  161 |         // Search content
  162 |         this.searchPrimaryContent = page.locator('#IDX-search-primary-content');
  163 |
  164 |         // Status option
  165 |         this.activeStatusOption = page.locator('.select2-results').getByRole('option', { name: 'Active' });
  166 |     }
  167 |     
  168 |     /**
  169 |      * Go directly to the Add Widget page
  170 |      */
  171 |     async goto() {
  172 |         await this.page.goto(this.globalAndEnvironmentVariables.MW_BASE_URL + '/mgmt/widgets/create');
  173 |     }
  174 |     
  175 |     /**
  176 |      * Select a widget type
  177 |      * @param widgetType - Type of widget to select (slideshow, showcase, carousel, etc.)
  178 |      */
  179 |     async selectWidgetType(widgetType: 'slideshow' | 'showcase' | 'carousel' | 'quicksearch' | 'mapsearch' | 'leadlogin' | 'leadsignup' | 'featuredagent') {
> 180 |         await this.widgetTypeSelector.click();
      |                                       ^ TimeoutError: locator.click: Timeout 20000ms exceeded.
  181 |                 
  182 |         switch (widgetType) {
  183 |             case 'slideshow':
  184 |                 await this.slideshowWidgetType.click();
  185 |                 break;
  186 |             case 'showcase':
  187 |                 await this.showcaseWidgetType.click();
  188 |                 break;
  189 |             case 'carousel':
  190 |                 await this.carouselWidgetType.click();
  191 |                 break;
  192 |             case 'quicksearch':
  193 |                 await this.quickSearchWidgetType.click();
  194 |                 break;
  195 |             case 'mapsearch':
  196 |                 await this.mapSearchWidgetType.click();
  197 |                 break;
  198 |             case 'leadlogin':
  199 |                 await this.leadLoginWidgetType.click();
  200 |                 break;
  201 |             case 'leadsignup':
  202 |                 await this.leadSignupWidgetType.click();
  203 |                 break;
  204 |             case 'featuredagent':
  205 |                 await this.featuredAgentWidgetType.click();
  206 |                 break;
  207 |         }
  208 |         
  209 |     }
  210 |     
  211 |     /**
  212 |      * Select property set
  213 |      * @param propSet - Property set to select (featured, supplemental, customSearch, etc.)
  214 |      */
  215 |     async selectPropertySet(propSet: 'featured' | 'supplemental' | 'featuredSupplemental' | 'agent' | 'soldPending' | 'customSearch' | 'customList' | 'polygonSearch' | 'copyAndPaste') {
  216 |         // Wait for the property set container to become visible
  217 |         //await this.propSetContainer.waitFor({ state: 'visible' });
  218 |         await this.propSetSelector.click();
  219 |         await waitForPageToBeFullyLoaded(this.page);
  220 |         
  221 |         switch (propSet) {
  222 |             case 'featured':
  223 |                 await this.featuredPropSet.click();
  224 |                 break;
  225 |             case 'supplemental':
  226 |                 await this.supplementalPropSet.click();
  227 |                 break;
  228 |             case 'featuredSupplemental':
  229 |                 await this.featuredSupplementalPropSet.click();
  230 |                 break;
  231 |             case 'agent':
  232 |                 await this.agentPropSet.click();
  233 |                 break;
  234 |             case 'soldPending':
  235 |                 await this.soldPendingPropSet.click();
  236 |                 break;
  237 |             case 'customSearch':
  238 |                 await this.customSearchPropSet.click();
  239 |                 break;
  240 |             case 'customList':
  241 |                 await this.customListPropSet.click();
  242 |                 break;
  243 |             case 'polygonSearch':
  244 |                 await this.polygonSearchPropSet.click();
  245 |                 break;
  246 |             case 'copyAndPaste':
  247 |                 await this.copyAndPastePropSet.click();
  248 |                 break;
  249 |         }
  250 |         
  251 |         await waitForPageToBeFullyLoaded(this.page);
  252 |     }
  253 |     
  254 |     /**
  255 |      * Select a search page (used with customSearch property set)
  256 |      * @param searchPageName - Name of the search page to select
  257 |      */
  258 |     async selectSearchPage(searchPageName: 'Advanced Search' | 'Basic Search' | 'Address' | 'Listing ID' | 'Email Update Signup') {
  259 |         await this.searchPageSelector.click({ force: true });
  260 |         await waitForPageToBeFullyLoaded(this.page);
  261 |         
  262 |         switch (searchPageName) {
  263 |             case 'Advanced Search':
  264 |                 await this.advancedSearchResultLabel.click();
  265 |                 break;
  266 |             case 'Basic Search':
  267 |                 await this.basicSearchResultLabel.click();
  268 |                 break;
  269 |             case 'Address':
  270 |                 await this.addressResultLabel.click();
  271 |                 break;
  272 |             case 'Listing ID':
  273 |                 await this.listingIdResultLabel.click();
  274 |                 break;
  275 |             case 'Email Update Signup':
  276 |                 await this.emailUpdateSignupResultLabel.click();
  277 |                 break;
  278 |         }
  279 |     }
  280 |     
```